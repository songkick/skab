#!/usr/bin/env ruby

unless $LOAD_PATH.include?(File.dirname(__FILE__) + '/../lib')
  $LOAD_PATH.unshift(File.dirname(__FILE__) + '/../lib')
end

usage = <<-USAGE
Usage: statisfish [output] [model] [extra_params]
\tTry `statisfish help [model]` for more info about a specific model and its
\tparameters
USAGE

require 'statisfish/models'
require 'statisfish/output'

if ARGV.empty?
  puts usage
  exit
end

if ARGV[0] == 'help'
  if ARGV[1]
    model = Statisfish::Models.from_name(ARGV[1])
    puts model.help
  else
    puts usage
  end
  exit
end

model = Statisfish::Models.from_name(ARGV[1])
model.run(ARGV.slice(2, ARGV.length))

output = Statisfish::Output.from_name(ARGV[0]).new(STDOUT)
output.output(model)
